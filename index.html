<!DOCTYPE html>
<html>

<head>
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"/>

    <!-- Material Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet"/>

    <?!= include('styles/main'); ?>
</head>

<body>
<div class="container-fluid">
    <div data-id="navigation"></div>
    <div data-id="loader" class="loader" style="display:none;"></div>
    <?!= include('pages/book-list', {pageId: 'books-page'}) ?>
    <?!= include('pages/add-book', {pageId: 'add-book-page'}) ?>
    <?!= include('pages/orders', {pageId: 'orders-page'}) ?>
    <?!= include('pages/edit-book', {pageId: 'edit-book-page'}) ?>
    <?!= include('pages/deleted-list', {pageId: 'deleted-list-page'}) ?>
    <?!= include('pages/about-page', {pageId: 'about-page'}) ?>
</div>
</body>
<?!= include('components/navigation', {dataId: 'navigation'}) ?>
<?!= include('components/custom-table') ?>
<?!= include('components/variable-container') ?>
<script>
    let loader = null
    const env = "dev"
    window.onload = function () {
        window.App = window.App || {}
        const navigationEl = document.querySelector('[data-id="navigation"]')
        loader = new Loader(document.querySelector(`[data-id="loader"]`))
        createNavigationPages(navigationEl)
        if (!App.BookList) {
            console.error('BookList not initialized', App);
            return
        }
        if (!App.AddBook) {
            console.error('AddBook not initialized', App);
            return
        }
        if (!App.Orders) {
            console.error('Orders not initialized', App);
            return
        }
        if (!App.Navigation) {
            console.error('Navigation not initialized', App);
        }
    };

    class Loader {
        constructor(element) {
            this.element = element
        }

        show() {
            this.element.style.display = "block"
        }

        hide() {
            this.element.style.display = "none"
        }
    }

    function createNavigationPages(navigationEl) {
        const booksListEl = document.querySelector('[data-id="books-page"]')
        const addBookEl = document.querySelector('[data-id="add-book-page"]')
        const ordersEl = document.querySelector('[data-id="orders-page"]')
        const editBookEl = document.querySelector('[data-id="edit-book-page"]')
        const deletedListEl = document.querySelector('[data-id="deleted-list-page"]')
        const aboutEl = document.querySelector('[data-id="about-page"]')
        App.Navigation.add("books-page", "Книги", booksListEl, App.BookList, true)
        App.Navigation.add("add-book-page", "Добавить новую", addBookEl, App.AddBook)
        App.Navigation.add("orders-page", "Сделать заказ", ordersEl, App.Orders)
        App.Navigation.add("edit-book-page", "Список книг", editBookEl, App.EditBook)
        App.Navigation.add("deleted-list-page", "Удаленные книги", deletedListEl, App.DeletedBookList)
        App.Navigation.add("about-page", "О нас", aboutEl)
        App.Navigation.init("edit-book-page", navigationEl, loader)
    }
</script>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"></script>
</body>

</html>